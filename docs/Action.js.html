<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Action.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Action.html">Action</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#.createReducer">createReducer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#.initial">initial</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#action">action</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#error">error</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#on">on</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#onError">onError</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#onStarted">onStarted</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#onSuccess">onSuccess</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#started">started</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#success">success</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Action.html#type">type</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Controller.html">Controller</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#.is">is</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#$">$</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#$$">$$</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#afterCreateStore">afterCreateStore</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#areStatesEqual">areStatesEqual</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#createAction">createAction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#createReducer">createReducer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#dispatchAction">dispatchAction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#reducer">reducer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Controller.html#subscribe">subscribe</a></span></li><li class="nav-heading">Externals</li><li class="nav-heading"><span class="nav-item-type type-external">E</span><span class="nav-item-name"><a href="external-Store.html">Store</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="external-Store.html#.getController">getController</a></span></li><li class="nav-heading">Namespaces</li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="Action.Stage.html">Stage</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#combineReducers">combineReducers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#Container">Container</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createStore">createStore</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">Action.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import _Symbol from './utils/_Symbol'

const $$initial = _Symbol('initial')

/**
 * Utility class for dealing with Redux actions. The instance of the class acts like an identifier
 * for action. Under the hood it stil uses string identifiers and follows
 * [Flux Standard Action]{@link https://github.com/acdlite/flux-standard-action}.
 *
 * Actions can have "stages", which are basically separate actions from Redux point of view. They
 * can be used to logically  group otherwise different actions if they represent the same action,
 * but happening in multiple stages (e.g. consider asynchronous request pattern "started" ->
 * "success" or "error").
 *
 * @example
 * const todoAdded = new Action("todoAdded")
 *
 * // Dispatch
 * dispatch(todoAdded.action({ text: "Todo text" }))
 *
 * // Reducer
 * const reducer = Action.createReducer(
 *   Action.initial({ todos: [] }), // default initial value is { }
 *
 *   todoAdded.on((state, item) => ({ todos: [...state.todos, item] }))
 * )
 */
class Action {
  /**
   * @namespace
   * @property {string} STARTED - An asynchronous operation was started.
   * @property {string} SUCCESS - An asynchronous operation was completed with success.
   * @property {string} ERROR - Action resolved to error. Payload contains `{ error: true }`
   *   and [Error]{@link https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Error}
   *   object as a payload.
   */
  static get Stage () {
    return {
      STARTED: 'started',
      SUCCESS: 'success',
      ERROR: 'error'
    }
  }

  /**
   * @param {string} baseType Base type identifier for the action.
   */
  constructor (baseType) {
    this.baseType = baseType
  }

  /**
   * Generates type identifier for specified stage.
   * @param {string=} stage Name of the stage.
   * @returns {string} Type for the action in specified stage.
   */
  type (stage) {
    const {baseType} = this
    return (typeof baseType === 'function' ? baseType() : baseType) +
      (stage ? '.' + stage : '')
  }

  /**
   * Generates type identifier for `STARTED` stage.
   * @returns {string} Type for the action in `STARTED` stage.
   * @private
   */
  typeStarted () {
    return this.type(Action.Stage.STARTED)
  }

  /**
   * Generates type identifier for `SUCCESS` stage.
   * @returns {string} Type for the action in `SUCCESS` stage.
   * @private
   */
  typeSuccess () {
    return this.type(Action.Stage.SUCCESS)
  }

  /**
   * Generates type identifier for `ERROR` stage.
   * @returns {string} Type for the action in `ERROR` stage.
   * @private
   */
  typeError () {
    return this.type(Action.Stage.ERROR)
  }

  /**
   * Creates plain action object which can be passed to `dispatch()` function.
   * @param {string=} stage To use when creating the action object.
   * @param payload Payload to be attached to the action object.
   * @returns {Object} Plain action object.
   */
  action () {
    var stage = arguments[0]
    var payload = arguments[1]

    if (arguments.length === 1) {
      stage = undefined
      payload = arguments[0]
    }

    return { type: this.type(stage), payload }
  }

  /**
   * Convenience function. Create plain action object with `STARTED` stage.
   * See [action()]{@link Action#action}.
   * @param payload Payload to be attached to the action object.
   * @returns {Object} Plain action object.
   */
  started (payload) {
    return this.action(Action.Stage.STARTED, payload)
  }

  /**
   * Convenience function. Create plain action object with `SUCCESS` stage.
   * See [action()]{@link Action#action}.
   * @param payload Payload to be attached to the action object.
   * @returns {Object} Plain action object.
   */
  success (payload) {
    return this.action(Action.Stage.SUCCESS, payload)
  }

  /**
   * Convenience function. Create plain action object with `ERROR` stage.
   * See [action()]{@link Action#action}.
   * @param payload Payload to be attached to the action object.
   * @returns {Object} Plain action object.
   */
  error (payload) {
    return { type: this.typeError(), payload, error: true }
  }

  /**
   * Wraps the provided handler function into a condition check, so the function is only called
   * if it receives the action with type equal to one of this action. Stage is taken into account
   * if specified. Reducer function will receive only payload part of the action.
   * @param {stage=} stage Process actions of specified stage.
   * @param {function(state, payload)} handler Handler function.
   * @returns {function} Wrapper handler function.
   */
  on () {
    var stage = arguments[0]
    var handler = arguments[1]

    if (arguments.length === 1) {
      stage = undefined
      handler = arguments[0]
    }

    return (state, action) => {
      if (action.type === this.type(stage)) {
        return handler(state, action.payload)
      }
    }
  }

  /**
   * Convenience function. Wraps handler for processing `STARTED` stage.
   * See [on()]{@link Action#on}.
   * @param {function(state, payload)} handler Handler function.
   * @returns {function} Wrapper handler function.
   */
  onStarted (handler) {
    return this.on(Action.Stage.STARTED, handler)
  }

  /**
   * Convenience function. Wraps handler for processing `SUCCESS` stage.
   * See [on()]{@link Action#on}.
   * @param {function(state, payload)} handler Handler function.
   * @returns {function} Wrapper handler function.
   */
  onSuccess (handler) {
    return this.on(Action.Stage.SUCCESS, handler)
  }

  /**
   * Convenience function. Wraps handler for processing `ERROR` stage.
   * See [on()]{@link Action#on}.
   * @param {function(state, payload)} handler Handler function.
   * @returns {function} Wrapper handler function.
   */
  onError (handler) {
    return this.on(Action.Stage.ERROR, handler)
  }

  /**
   * Pass the result of the call to [createReducer()]{@link Action.createReducer} to define the
   * initial value of the resulting reducer.
   * @param valueOrFunc If function is passed it will be called when reducer needs initial value.
   *   Otherwise provided value is used as is by the reducer.
   * @example
   * Action.createReducer(
   *   Action.initial({ foo: 'bar' })
   * )
   */
  static initial (valueOrFunc) {
    const func = typeof valueOrFunc === 'function' ? valueOrFunc : () => valueOrFunc

    Object.defineProperty(func, $$initial, {
      value: true
    })

    return func
  }

  /**
   * Combines all of the passed handlers to form a single reducer. Handlers can be a wrapped
   * handlers from [Action.on()]{@link Action#on} calls as well as regular reducer functions.
   *
   * The default initial value for reducer is `{ }` (empty object). It can be overridden with
   * [Action.initial()]{@link Action.initial}.
   *
   * If the first argument passed is a string, the resulting reducer will have all of the attached
   * handlers operating on the sub key of the passed state rather than on the state itself.
   *
   * @param {string=} subKey Sub key for handlers to operate on.
   * @param {function} args Handler functions to be combined into the single reducer.
   * @returns {function} Redux-compatible reducer function.
   */
  static createReducer (...args) {
    var actionHandlers = args
    var key

    if (typeof args[0] !== 'function') {
      if (typeof args[0] === 'string') {
        key = args[0]
      }

      actionHandlers = args.slice(1)
    }

    var initial = actionHandlers.find((h) => h[$$initial]) || (() => ({}))
    actionHandlers = actionHandlers.filter((h) => !h[$$initial])

    return (state, action) => {
      let parentState
      if (key) {
        parentState = state
        state = state[key]
      }

      if (state === undefined) {
        state = initial()
      } else {
        actionHandlers.forEach((actionHandler) => {
          const newState = actionHandler(state, action)
          if (newState !== undefined) {
            state = newState
          }
        })
      }

      if (parentState) {
        return Object.assign({ }, parentState, { [key]: state })
      } else {
        return state
      }
    }
  }
}

export default Action
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.3</a> on Fri Jul 21 2017 00:27:34 GMT+0300 (EEST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
